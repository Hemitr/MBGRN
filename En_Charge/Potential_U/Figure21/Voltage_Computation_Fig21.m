% Flux Modèle circuit de réluctances
clear all

%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Voltage computation %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%

load FichFlux

xd1 = [tp+l:l:2*tp];
for i=1:length(xd1)
    FluxC(length(xd)+i) = -FluxC(i+1);
end
xd2 = [0:l:2*tp];
for i=1:length(xd2)-1
    FEMC(i) = (FluxC(i+1)-FluxC(i))/0.5e-3;
end
FEMC(length(xd2)) = FEMC(1);

%%%%%%%%%%%%%%%%%%%%%%
%%% Flux2D results %%%
%%%%%%%%%%%%%%%%%%%%%%

VC1=[ 0.00000000E+00      0.00000000E+00      0.00000000E+00      0.00000000E+00
      5.00000000E-04      8.86625581E+01     -1.46650456E+01     -7.19463959E+01
      1.00000000E-03      1.79288289E+00     -2.13931929E+00      2.39042499E+00
      1.50000000E-03      1.76705389E+00     -2.12649125E+00      2.38762356E+00
      2.00000000E-03      1.73037238E+00     -2.11018746E+00      2.37996061E+00
      2.50000000E-03      1.67626612E+00     -2.08846501E+00      2.36573543E+00
      3.00000000E-03      1.60065351E+00     -2.06060796E+00      2.34442534E+00
      3.50000000E-03      1.50912737E+00     -2.02960841E+00      2.31922673E+00
      4.00000000E-03      1.41046933E+00     -1.99911044E+00      2.29394594E+00
      4.50000000E-03      1.30958510E+00     -1.97084085E+00      2.27040270E+00
      5.00000000E-03      1.20779083E+00     -1.94509742E+00      2.24894591E+00
      5.50000000E-03      1.10470383E+00     -1.92160182E+00      2.22932927E+00
      6.00000000E-03      9.98942694E-01     -1.89980126E+00      2.21102181E+00
      6.50000000E-03      8.87989257E-01     -1.87883307E+00      2.19317390E+00
      7.00000000E-03      7.67582576E-01     -1.85733749E+00      2.17442928E+00
      7.50000000E-03      6.30890457E-01     -1.83322021E+00      2.15268617E+00
      8.00000000E-03      4.73631789E-01     -1.80569399E+00      2.12717569E+00
      8.50000000E-03      3.01263523E-01     -1.77775188E+00      2.10096793E+00
      9.00000000E-03      1.22508153E-01     -1.75311128E+00      2.07784725E+00
      9.50000000E-03     -5.76785051E-02     -1.73365330E+00      2.05971431E+00
      1.00000000E-02     -2.37749430E-01     -1.71992983E+00      2.04711411E+00
      1.05000000E-02     -4.17525821E-01     -1.71204770E+00      2.04013867E+00
      1.10000000E-02     -5.97147653E-01     -1.71001997E+00      2.03878511E+00
      1.15000000E-02     -7.76436433E-01     -1.71376463E+00      2.04295694E+00
      1.20000000E-02     -9.53845755E-01     -1.72274656E+00      2.05211275E+00
      1.25000000E-02     -1.12442073E+00     -1.73507479E+00      2.06438203E+00
      1.30000000E-02     -1.27944008E+00     -1.74697446E+00      2.07605813E+00
      1.35000000E-02     -1.41344840E+00     -1.75538482E+00      2.08415887E+00
      1.40000000E-02     -1.53072864E+00     -1.76108388E+00      2.08948244E+00
      1.45000000E-02     -1.63811514E+00     -1.76618236E+00      2.09413427E+00
      1.50000000E-02     -1.73987128E+00     -1.77204528E+00      2.09948527E+00
      1.55000000E-02     -1.83851796E+00     -1.77953075E+00      2.10640940E+00
      1.60000000E-02     -1.93543965E+00     -1.78917811E+00      2.11547081E+00
      1.65000000E-02     -2.03102237E+00     -1.80124170E+00      2.12695925E+00
      1.70000000E-02     -2.12395361E+00     -1.81538053E+00      2.14058846E+00
      1.75000000E-02     -2.20933158E+00     -1.82978250E+00      2.15464318E+00
      1.80000000E-02     -2.27837885E+00     -1.84064864E+00      2.16549096E+00
      1.85000000E-02     -2.32550711E+00     -1.84478975E+00      2.17015135E+00
      1.90000000E-02     -2.35480275E+00     -1.84273542E+00      2.16935198E+00
      1.95000000E-02     -2.37284199E+00     -1.83619392E+00      2.16504733E+00
      2.00000000E-02     -2.38356524E+00     -1.82590998E+00      2.15835862E+00
      2.05000000E-02     -2.38910599E+00     -1.81179121E+00      2.14978060E+00
      2.10000000E-02     -2.39042592E+00     -1.79288181E+00      2.13931914E+00
      2.15000000E-02     -2.38762356E+00     -1.76705389E+00      2.12649125E+00
      2.20000000E-02     -2.37996061E+00     -1.73037238E+00      2.11018746E+00
      2.25000000E-02     -2.36573543E+00     -1.67626612E+00      2.08846501E+00
      2.30000000E-02     -2.34442534E+00     -1.60065351E+00      2.06060796E+00
      2.35000000E-02     -2.31922673E+00     -1.50912737E+00      2.02960841E+00
      2.40000000E-02     -2.29394594E+00     -1.41046933E+00      1.99911044E+00
      2.45000000E-02     -2.27040270E+00     -1.30958510E+00      1.97084085E+00
      2.50000000E-02     -2.24894591E+00     -1.20779083E+00      1.94509742E+00
      2.55000000E-02     -2.22932927E+00     -1.10470383E+00      1.92160182E+00
      2.60000000E-02     -2.21102181E+00     -9.98942694E-01      1.89980126E+00
      2.65000000E-02     -2.19317390E+00     -8.87989257E-01      1.87883307E+00
      2.70000000E-02     -2.17442928E+00     -7.67582576E-01      1.85733749E+00
      2.75000000E-02     -2.15268617E+00     -6.30890457E-01      1.83322021E+00
      2.80000000E-02     -2.12717569E+00     -4.73631789E-01      1.80569399E+00
      2.85000000E-02     -2.10096793E+00     -3.01263523E-01      1.77775188E+00
      2.90000000E-02     -2.07784725E+00     -1.22508153E-01      1.75311128E+00
      2.95000000E-02     -2.05971431E+00      5.76785051E-02      1.73365330E+00
      3.00000000E-02     -2.04711411E+00      2.37749430E-01      1.71992983E+00
      3.05000000E-02     -2.04013867E+00      4.17525821E-01      1.71204770E+00
      3.10000000E-02     -2.03878511E+00      5.97147653E-01      1.71001997E+00
      3.15000000E-02     -2.04295694E+00      7.76436433E-01      1.71376463E+00
      3.20000000E-02     -2.05211275E+00      9.53845755E-01      1.72274656E+00
      3.25000000E-02     -2.06438203E+00      1.12442073E+00      1.73507479E+00
      3.30000000E-02     -2.07605813E+00      1.27944008E+00      1.74697446E+00
      3.35000000E-02     -2.08415887E+00      1.41344840E+00      1.75538482E+00
      3.40000000E-02     -2.08948244E+00      1.53072864E+00      1.76108388E+00
      3.45000000E-02     -2.09413427E+00      1.63811514E+00      1.76618236E+00
      3.50000000E-02     -2.09948527E+00      1.73987128E+00      1.77204528E+00
      3.55000000E-02     -2.10640940E+00      1.83851796E+00      1.77953075E+00
      3.60000000E-02     -2.11547081E+00      1.93543965E+00      1.78917811E+00
      3.65000000E-02     -2.12695925E+00      2.03102237E+00      1.80124170E+00
      3.70000000E-02     -2.14058846E+00      2.12395361E+00      1.81538053E+00
      3.75000000E-02     -2.15464318E+00      2.20933158E+00      1.82978250E+00
      3.80000000E-02     -2.16549096E+00      2.27837885E+00      1.84064864E+00
      3.85000000E-02     -2.17015135E+00      2.32550711E+00      1.84478975E+00
      3.90000000E-02     -2.16935198E+00      2.35480275E+00      1.84273542E+00
      3.95000000E-02     -2.16504733E+00      2.37284199E+00      1.83619392E+00
      4.00000000E-02     -2.15835862E+00      2.38356524E+00      1.82590998E+00
      4.05000000E-02     -2.14978060E+00      2.38910599E+00      1.81179121E+00
      4.10000000E-02     -2.13931914E+00      2.39042592E+00      1.79288181E+00
      4.15000000E-02     -2.12649125E+00      2.38762356E+00      1.76705389E+00
      4.20000000E-02     -2.11018746E+00      2.37996061E+00      1.73037238E+00
      4.25000000E-02     -2.08846501E+00      2.36573543E+00      1.67626612E+00
      4.30000000E-02     -2.06060796E+00      2.34442534E+00      1.60065351E+00
      4.35000000E-02     -2.02960841E+00      2.31922673E+00      1.50912737E+00
      4.40000000E-02     -1.99911044E+00      2.29394594E+00      1.41046933E+00
      4.45000000E-02     -1.97084085E+00      2.27040270E+00      1.30958510E+00
      4.50000000E-02     -1.94509742E+00      2.24894591E+00      1.20779083E+00
      4.55000000E-02     -1.92160182E+00      2.22932927E+00      1.10470383E+00
      4.60000000E-02     -1.89980126E+00      2.21102181E+00      9.98942694E-01
      4.65000000E-02     -1.87883307E+00      2.19317390E+00      8.87989257E-01
      4.70000000E-02     -1.85733749E+00      2.17442928E+00      7.67582576E-01
      4.75000000E-02     -1.83322021E+00      2.15268617E+00      6.30890457E-01
      4.80000000E-02     -1.80569399E+00      2.12717569E+00      4.73631789E-01
      4.85000000E-02     -1.77775188E+00      2.10096793E+00      3.01263523E-01
      4.90000000E-02     -1.75311128E+00      2.07784725E+00      1.22508153E-01
      4.95000000E-02     -1.73365330E+00      2.05971431E+00     -5.76785051E-02
      5.00000000E-02     -1.71992983E+00      2.04711411E+00     -2.37749430E-01
      5.05000000E-02     -1.71204770E+00      2.04013867E+00     -4.17525821E-01
      5.10000000E-02     -1.71001997E+00      2.03878511E+00     -5.97147653E-01
      5.15000000E-02     -1.71376463E+00      2.04295694E+00     -7.76436433E-01
      5.20000000E-02     -1.72274656E+00      2.05211275E+00     -9.53845755E-01
      5.25000000E-02     -1.73507479E+00      2.06438203E+00     -1.12442073E+00
      5.30000000E-02     -1.74697446E+00      2.07605813E+00     -1.27944008E+00
      5.35000000E-02     -1.75538482E+00      2.08415887E+00     -1.41344840E+00
      5.40000000E-02     -1.76108388E+00      2.08948244E+00     -1.53072864E+00
      5.45000000E-02     -1.76618236E+00      2.09413427E+00     -1.63811514E+00
      5.50000000E-02     -1.77204528E+00      2.09948527E+00     -1.73987128E+00
      5.55000000E-02     -1.77953075E+00      2.10640940E+00     -1.83851796E+00
      5.60000000E-02     -1.78917811E+00      2.11547081E+00     -1.93543965E+00
      5.65000000E-02     -1.80124170E+00      2.12695925E+00     -2.03102237E+00
      5.70000000E-02     -1.81538053E+00      2.14058846E+00     -2.12395361E+00
      5.75000000E-02     -1.82978250E+00      2.15464318E+00     -2.20933158E+00
      5.80000000E-02     -1.84064864E+00      2.16549096E+00     -2.27837885E+00
      5.85000000E-02     -1.84478975E+00      2.17015135E+00     -2.32550711E+00
      5.90000000E-02     -1.84273542E+00      2.16935198E+00     -2.35480275E+00
      5.95000000E-02     -1.83619392E+00      2.16504733E+00     -2.37284199E+00
      6.00000000E-02     -1.82590998E+00      2.15835862E+00     -2.38356524E+00
      6.05000000E-02     -1.81179121E+00      2.14978060E+00     -2.38910599E+00
      6.10000000E-02     -1.79288181E+00      2.13931914E+00     -2.39042592E+00
      6.15000000E-02     -1.76705389E+00      2.12649125E+00     -2.38762356E+00
      6.20000000E-02     -1.73037238E+00      2.11018746E+00     -2.37996061E+00
      6.25000000E-02     -1.67626612E+00      2.08846501E+00     -2.36573543E+00
      6.30000000E-02     -1.60065351E+00      2.06060796E+00     -2.34442534E+00
      6.35000000E-02     -1.50912737E+00      2.02960841E+00     -2.31922673E+00
      6.40000000E-02     -1.41046933E+00      1.99911044E+00     -2.29394594E+00
      6.45000000E-02     -1.30958510E+00      1.97084085E+00     -2.27040270E+00
      6.50000000E-02     -1.20779083E+00      1.94509742E+00     -2.24894591E+00
      6.55000000E-02     -1.10470383E+00      1.92160182E+00     -2.22932927E+00
      6.60000000E-02     -9.98942694E-01      1.89980126E+00     -2.21102181E+00
      6.65000000E-02     -8.87989257E-01      1.87883307E+00     -2.19317390E+00
      6.70000000E-02     -7.67582576E-01      1.85733749E+00     -2.17442928E+00
      6.75000000E-02     -6.30890457E-01      1.83322021E+00     -2.15268617E+00
      6.80000000E-02     -4.73631789E-01      1.80569399E+00     -2.12717569E+00
      6.85000000E-02     -3.01263523E-01      1.77775188E+00     -2.10096793E+00
      6.90000000E-02     -1.22508153E-01      1.75311128E+00     -2.07784725E+00
      6.95000000E-02      5.76785051E-02      1.73365330E+00     -2.05971431E+00
      7.00000000E-02      2.37749430E-01      1.71992983E+00     -2.04711411E+00
      7.05000000E-02      4.17525821E-01      1.71204770E+00     -2.04013867E+00
      7.10000000E-02      5.97147653E-01      1.71001997E+00     -2.03878511E+00
      7.15000000E-02      7.76436433E-01      1.71376463E+00     -2.04295694E+00
      7.20000000E-02      9.53845755E-01      1.72274656E+00     -2.05211275E+00
      7.25000000E-02      1.12442073E+00      1.73507479E+00     -2.06438203E+00
      7.30000000E-02      1.27944008E+00      1.74697446E+00     -2.07605813E+00
      7.35000000E-02      1.41344840E+00      1.75538482E+00     -2.08415887E+00
      7.40000000E-02      1.53072864E+00      1.76108388E+00     -2.08948244E+00
      7.45000000E-02      1.63811514E+00      1.76618236E+00     -2.09413427E+00
      7.50000000E-02      1.73987128E+00      1.77204528E+00     -2.09948527E+00
      7.55000000E-02      1.83851796E+00      1.77953075E+00     -2.10640940E+00
      7.60000000E-02      1.93543965E+00      1.78917811E+00     -2.11547081E+00
      7.65000000E-02      2.03102237E+00      1.80124170E+00     -2.12695925E+00
      7.70000000E-02      2.12395361E+00      1.81538053E+00     -2.14058846E+00
      7.75000000E-02      2.20933158E+00      1.82978250E+00     -2.15464318E+00
      7.80000000E-02      2.27837885E+00      1.84064864E+00     -2.16549096E+00
      7.85000000E-02      2.32550711E+00      1.84478975E+00     -2.17015135E+00
      7.90000000E-02      2.35480275E+00      1.84273542E+00     -2.16935198E+00
      7.95000000E-02      2.37284199E+00      1.83619392E+00     -2.16504733E+00
      8.00000000E-02      2.38356524E+00      1.82590998E+00     -2.15835862E+00
      8.05000000E-02      2.38910599E+00      1.81179121E+00     -2.14978060E+00
      8.10000000E-02      2.39042592E+00      1.79288181E+00     -2.13931914E+00
      8.15000000E-02      2.38762356E+00      1.76705389E+00     -2.12649125E+00
      8.20000000E-02      2.37996061E+00      1.73037238E+00     -2.11018746E+00
      8.25000000E-02      2.36573543E+00      1.67626612E+00     -2.08846501E+00
      8.30000000E-02      2.34442534E+00      1.60065351E+00     -2.06060796E+00
      8.35000000E-02      2.31922673E+00      1.50912737E+00     -2.02960841E+00
      8.40000000E-02      2.29394594E+00      1.41046933E+00     -1.99911044E+00
      8.45000000E-02      2.27040270E+00      1.30958510E+00     -1.97084085E+00
      8.50000000E-02      2.24894591E+00      1.20779083E+00     -1.94509742E+00
      8.55000000E-02      2.22932927E+00      1.10470383E+00     -1.92160182E+00
      8.60000000E-02      2.21102181E+00      9.98942694E-01     -1.89980126E+00
      8.65000000E-02      2.19317390E+00      8.87989257E-01     -1.87883307E+00
      8.70000000E-02      2.17442928E+00      7.67582576E-01     -1.85733749E+00
      8.75000000E-02      2.15268617E+00      6.30890457E-01     -1.83322021E+00
      8.80000000E-02      2.12717569E+00      4.73631789E-01     -1.80569399E+00
      8.85000000E-02      2.10096793E+00      3.01263523E-01     -1.77775188E+00
      8.90000000E-02      2.07784725E+00      1.22508153E-01     -1.75311128E+00
      8.95000000E-02      2.05971431E+00     -5.76785051E-02     -1.73365330E+00
      9.00000000E-02      2.04711411E+00     -2.37749430E-01     -1.71992983E+00
      9.05000000E-02      2.04013867E+00     -4.17525821E-01     -1.71204770E+00
      9.10000000E-02      2.03878511E+00     -5.97147653E-01     -1.71001997E+00
      9.15000000E-02      2.04295694E+00     -7.76436433E-01     -1.71376463E+00
      9.20000000E-02      2.05211275E+00     -9.53845755E-01     -1.72274656E+00
      9.25000000E-02      2.06438203E+00     -1.12442073E+00     -1.73507479E+00
      9.30000000E-02      2.07605813E+00     -1.27944008E+00     -1.74697446E+00
      9.35000000E-02      2.08415887E+00     -1.41344840E+00     -1.75538482E+00
      9.40000000E-02      2.08948244E+00     -1.53072864E+00     -1.76108388E+00
      9.45000000E-02      2.09413427E+00     -1.63811514E+00     -1.76618236E+00
      9.50000000E-02      2.09948527E+00     -1.73987128E+00     -1.77204528E+00
      9.55000000E-02      2.10640940E+00     -1.83851796E+00     -1.77953075E+00
      9.60000000E-02      2.11547081E+00     -1.93543965E+00     -1.78917811E+00
      9.65000000E-02      2.12695925E+00     -2.03102237E+00     -1.80124170E+00
      9.70000000E-02      2.14058846E+00     -2.12395361E+00     -1.81538053E+00
      9.75000000E-02      2.15464318E+00     -2.20933158E+00     -1.82978250E+00
      9.80000000E-02      2.16549096E+00     -2.27837885E+00     -1.84064864E+00
      9.85000000E-02      2.17015135E+00     -2.32550711E+00     -1.84478975E+00
      9.90000000E-02      2.16935198E+00     -2.35480275E+00     -1.84273542E+00
      9.95000000E-02      2.16504733E+00     -2.37284199E+00     -1.83619392E+00
      1.00000000E-01      2.15835862E+00     -2.38356524E+00     -1.82590998E+00
      1.00500000E-01      2.14978060E+00     -2.38910599E+00     -1.81179121E+00
      1.01000000E-01      2.13931914E+00     -2.39042592E+00     -1.79288181E+00
      1.01500000E-01      2.12649125E+00     -2.38762356E+00     -1.76705389E+00
      1.02000000E-01      2.11018746E+00     -2.37996061E+00     -1.73037238E+00
      1.02500000E-01      2.08846501E+00     -2.36573543E+00     -1.67626612E+00
      1.03000000E-01      2.06060796E+00     -2.34442534E+00     -1.60065351E+00
      1.03500000E-01      2.02960841E+00     -2.31922673E+00     -1.50912737E+00
      1.04000000E-01      1.99911044E+00     -2.29394594E+00     -1.41046933E+00
      1.04500000E-01      1.97084085E+00     -2.27040270E+00     -1.30958510E+00
      1.05000000E-01      1.94509742E+00     -2.24894591E+00     -1.20779083E+00
      1.05500000E-01      1.92160182E+00     -2.22932927E+00     -1.10470383E+00
      1.06000000E-01      1.89980126E+00     -2.21102181E+00     -9.98942694E-01
      1.06500000E-01      1.87883307E+00     -2.19317390E+00     -8.87989257E-01
      1.07000000E-01      1.85733749E+00     -2.17442928E+00     -7.67582576E-01
      1.07500000E-01      1.83322021E+00     -2.15268617E+00     -6.30890457E-01
      1.08000000E-01      1.80569399E+00     -2.12717569E+00     -4.73631789E-01
      1.08500000E-01      1.77775188E+00     -2.10096793E+00     -3.01263523E-01
      1.09000000E-01      1.75311128E+00     -2.07784725E+00     -1.22508153E-01
      1.09500000E-01      1.73365330E+00     -2.05971431E+00      5.76785051E-02
      1.10000000E-01      1.71992983E+00     -2.04711411E+00      2.37749430E-01
      1.10500000E-01      1.71204770E+00     -2.04013867E+00      4.17525821E-01
      1.11000000E-01      1.71001997E+00     -2.03878511E+00      5.97147653E-01
      1.11500000E-01      1.71376463E+00     -2.04295694E+00      7.76436433E-01
      1.12000000E-01      1.72274656E+00     -2.05211275E+00      9.53845755E-01
      1.12500000E-01      1.73507479E+00     -2.06438203E+00      1.12442073E+00
      1.13000000E-01      1.74697446E+00     -2.07605813E+00      1.27944008E+00
      1.13500000E-01      1.75538482E+00     -2.08415887E+00      1.41344840E+00
      1.14000000E-01      1.76108388E+00     -2.08948244E+00      1.53072864E+00
      1.14500000E-01      1.76618236E+00     -2.09413427E+00      1.63811514E+00
      1.15000000E-01      1.77204528E+00     -2.09948527E+00      1.73987128E+00
      1.15500000E-01      1.77953075E+00     -2.10640940E+00      1.83851796E+00
      1.16000000E-01      1.78917811E+00     -2.11547081E+00      1.93543965E+00
      1.16500000E-01      1.80124170E+00     -2.12695925E+00      2.03102237E+00
      1.17000000E-01      1.81538053E+00     -2.14058846E+00      2.12395361E+00
      1.17500000E-01      1.82978250E+00     -2.15464318E+00      2.20933158E+00
      1.18000000E-01      1.84064864E+00     -2.16549096E+00      2.27837885E+00
      1.18500000E-01      1.84478975E+00     -2.17015135E+00      2.32550711E+00
      1.19000000E-01      1.84273542E+00     -2.16935198E+00      2.35480275E+00
      1.19500000E-01      1.83619392E+00     -2.16504733E+00      2.37284199E+00
      1.20000000E-01      1.82590998E+00     -2.15835862E+00      2.38356524E+00];

x0 = [0:0.5e-3:60e-3];
for i=1:121
    VA(i) = VC1(i+60,2);
    VB(i) = VC1(i+60,3);
    VC(i) = VC1(i+60,4);
end

x1 = [60.5e-3:0.5e-3:120e-3];
for i=1:120
    VA(i+121) = -VC1(i+61,2);
    VB(i+121) = -VC1(i+61,3);
    VC(i+121) = -VC1(i+61,4);
end

x2=[0:0.5e-3:120e-3];

for i=1:length(x2)
    VA10(i) = VA(length(x2)-i+1);
    VB10(i) = VB(length(x2)-i+1);
    VC10(i) = VC(length(x2)-i+1);
end

x3=[120.5e-3:0.5e-3:240e-3];
for i=1:length(x3)
    VA10(length(x2)+i) = VA10(i+1);
    VB10(length(x2)+i) = VB10(i+1);
    VC10(length(x2)+i) = VC10(i+1);
end
x4=[0:0.5e-3:240e-3];

% For clarity reasons the number of points in the FEM results is reduced
for i=1:161
    FEM31(i) = x4(1+(i-1)*3)-0.01;
    FEM32(i) = VC10(1+(i-1)*3);
end
    
figure
plot(FEM31*1000,FEM32,'o')
hold on
plot(xd2*1000,FEMC)
axis([0 120 -2.5 2.5])

% The results from the FEM have been obtained for one pole pair